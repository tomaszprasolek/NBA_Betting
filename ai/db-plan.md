1. **Tables with Columns, Data Types, and Constraints**

   **AspNetUsers (Extended Identity Table)**
   - **Id**: NVARCHAR(450) – Primary Key (generated by ASP.NET Core Identity)
   - *(Other standard Identity columns extended with additional application-specific attributes)*

   **Leagues**
   - **LeagueId**: INT, IDENTITY, NOT NULL, PRIMARY KEY
   - **LeagueCode**: NVARCHAR(20), NOT NULL, UNIQUE
   - **LeagueName**: NVARCHAR(100), NOT NULL, UNIQUE
   - **Description**: NVARCHAR(MAX), NULL
   - **OwnerId**: NVARCHAR(450), NOT NULL, FOREIGN KEY REFERENCES AspNetUsers(Id)
   - **CreatedDate**: DATETIME2, NOT NULL, DEFAULT GETDATE()
   - **ModifiedDate**: DATETIME2, NOT NULL, DEFAULT GETDATE()

   **Teams**
   - **TeamId**: INT, IDENTITY, NOT NULL, PRIMARY KEY
   - **TeamName**: NVARCHAR(100), NOT NULL, UNIQUE

   **Matches**
   - **MatchId**: INT, IDENTITY, NOT NULL, PRIMARY KEY
   - **LeagueId**: INT, NOT NULL, FOREIGN KEY REFERENCES Leagues(LeagueId)
   - **HomeTeamId**: INT, NOT NULL, FOREIGN KEY REFERENCES Teams(TeamId)
   - **AwayTeamId**: INT, NOT NULL, FOREIGN KEY REFERENCES Teams(TeamId)
   - **MatchDateTime**: DATETIME2, NOT NULL
   - **Result**: TINYINT, NULL  
     *-- (Maps to an enum in the code, e.g., 1 = Home win, 2 = Away win, 3 = Overtime)*
   - **CreatedDate**: DATETIME2, NOT NULL, DEFAULT GETDATE()
   - **ModifiedDate**: DATETIME2, NOT NULL, DEFAULT GETDATE()
   - *Constraint*: CHECK (HomeTeamId <> AwayTeamId)

   **Bets**
   - **BetId**: INT, IDENTITY, NOT NULL, PRIMARY KEY
   - **UserId**: NVARCHAR(450), NOT NULL, FOREIGN KEY REFERENCES AspNetUsers(Id)
   - **MatchId**: INT, NOT NULL, FOREIGN KEY REFERENCES Matches(MatchId)
   - **BetChoice**: TINYINT, NOT NULL  
     *-- (Maps to an enum in the code, e.g., 1 = Home, 2 = Away, 3 = Overtime)*
   - **PointsAwarded**: INT, NOT NULL, DEFAULT 0
   - **CreatedDate**: DATETIME2, NOT NULL, DEFAULT GETDATE()

   **LeagueMemberships**
   - **MembershipId**: INT, IDENTITY, NOT NULL, PRIMARY KEY
   - **UserId**: NVARCHAR(450), NOT NULL, FOREIGN KEY REFERENCES AspNetUsers(Id)
   - **LeagueId**: INT, NOT NULL, FOREIGN KEY REFERENCES Leagues(LeagueId)
   - **RoleInLeague**: TINYINT, NOT NULL  
     *-- (Maps to an enum in the code, e.g., 1 = Admin, 2 = LeagueAdministrator, 3 = User)*
   - **CreatedDate**: DATETIME2, NOT NULL, DEFAULT GETDATE()
   - *Unique Constraint*: UNIQUE (UserId, LeagueId) – a user cannot join the same league more than once

2. **Relationships Between Tables**

   - **AspNetUsers – Leagues**: One-to-Many  
     *Each user (as owner) can create multiple leagues.*
     
   - **Leagues – Matches**: One-to-Many  
     *Each league can have multiple matches.*
     
   - **Teams – Matches**: One-to-Many  
     *Each match references two teams (HomeTeam and AwayTeam).*
     
   - **AspNetUsers – Bets**: One-to-Many  
     *Each user can place many bets on different matches.*
     
   - **Matches – Bets**: One-to-Many  
     *Each match can have many associated bets.*
     
   - **AspNetUsers – LeagueMemberships – Leagues**: Many-to-Many  
     *Users can belong to multiple leagues, and each league can have many users. This relationship is modeled by the LeagueMemberships table, which also records the user's role.*

3. **Indexes**

   - **Leagues**:
     - Unique index on **LeagueCode**
     - Unique index on **LeagueName**
     
   - **Teams**:
     - Unique index on **TeamName**
     
   - **Matches**:
     - Index on **LeagueId**
     - (Optional) Index on **MatchDateTime** to enhance filtering and sorting by date
     
   - **Bets**:
     - Index on **MatchId**
     - Index on **UserId**
     
   - **LeagueMemberships**:
     - Unique index on combination (UserId, LeagueId)

4. **Row-Level Security (RLS) and MSSQL Specifics**

   - Since the project uses MSSQL with EF Core, advanced Row-Level Security (RLS) is not implemented in this MVP as per the planning decisions.

5. **Additional Notes and Design Decisions**

   - **Extended Identity**: The standard ASP.NET Core Identity tables (AspNetUsers and related tables) are extended with additional attributes required for the application.
   - **Data Types and Enum Mapping**: Columns **BetChoice** and **RoleInLeague** are of type TINYINT to ensure that only pre-defined values (via code enums) can be stored.
   - **Audit Columns**: All main tables include audit columns (CreatedDate, ModifiedDate) to track data changes.
   - **Referential Integrity**: All foreign keys ensure data integrity. Cascading delete operations are deliberately omitted to simplify the MVP.
   - **Normalization**: The schema follows 3NF principles to maintain data integrity and scalability.
